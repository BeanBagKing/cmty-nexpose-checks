<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <xsd:element name="exploits" type="Exploits"/>

  <xsd:complexType name="Exploits">

    <xsd:sequence>
      <xsd:element name="exploit" minOccurs="1" maxOccurs="unbounded">
        <xsd:complexType>

          <xsd:all>

            <xsd:element name="source" minOccurs="1" maxOccurs="1">
              <xsd:simpleType>
                <xsd:restriction base="xsd:string">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                    The source must be one and only one of the following values
                    </xsd:documentation>
                  </xsd:annotation>
                  <xsd:enumeration value="exploitdb"/>
                  <xsd:enumeration value="metasploit"/>
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>

            <xsd:element name="rank" minOccurs="1" maxOccurs="1">
              <xsd:simpleType>
                <xsd:restriction base="xsd:string">
                  <xsd:enumeration value="Expert"/>
                  <xsd:enumeration value="Intermediate"/>
                  <xsd:enumeration value="Novice"/>
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>

            <xsd:element name="exploitrank" minOccurs="1" maxOccurs="1">
              <xsd:simpleType>
                <xsd:restriction base="xsd:string">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                    The exploitrank must be one and only one of these -->
                    </xsd:documentation>
                  </xsd:annotation>
                  <xsd:enumeration value="average"/>
                  <xsd:enumeration value="excellent"/>
                  <xsd:enumeration value="good"/>
                  <xsd:enumeration value="great"/>
                  <xsd:enumeration value="low"/>
                  <xsd:enumeration value="manual"/>
                  <xsd:enumeration value="normal"/>
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>

            <xsd:element name="name" type="xsd:string"/>
            <xsd:element name="id" type="xsd:string"/>
            <xsd:element name="description" type="xsd:string"/>

            <xsd:element name="vulnerabilities" minOccurs="1" maxOccurs="1">
              <xsd:complexType>
                <xsd:sequence>
                  <xsd:element name="vulnerability" minOccurs="1" maxOccurs="unbounded">
                    <xsd:complexType>
                      <xsd:attribute name="id" use="required" type="xsd:string"/>
                    </xsd:complexType>
                  </xsd:element>
                </xsd:sequence>
              </xsd:complexType>
              <xsd:unique name="unique-vulnerability-id">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                    Ensure that no vulnerabilities listed under this exploit are duplicated
                    </xsd:documentation>
                  </xsd:annotation>
                <xsd:selector xpath="vulnerability"/>
                <xsd:field xpath="@id"/>
              </xsd:unique>
            </xsd:element>

          </xsd:all>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

  </xsd:complexType>

</xsd:schema>
